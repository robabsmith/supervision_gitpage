"0","#########################################################################"
"0","# Danmarks statistik example"
"0","#########################################################################"
"0",""
"0","# This uses a package called statsDK, which needs to be built from Mikkel Krogsholm's the GitHub repo."
"0","# "
"0","#    install.packages(""devtools"")"
"0","#    library(devtools)"
"0","#    devtools::install_github(""mikkelkrogsholm/statsDK"")"
"0",""
"0","# Fetching interest rate data, and filter for mortgage products"
"0","#########################################################################"
"0","dk_mortgage_interest_raw_data <- data.table(sdk_retrieve_data(table_id = ""DNRNURI"", "
"0","                                                              DATA = paste0(c(""AL51EFFR"", ""AL51BIDS""),collapse = "",""),"
"0","                                                              INDSEK = paste0(c(""1400""),collapse = "",""),"
"0","                                                              VALUTA = ""z01"", "
"0","                                                              LÃ˜BETID1 = ""ALLE"","
"0","                                                              RENTFIX = paste0(c(""1A"", ""2A"", ""3A"", ""5A"", ""10A"", ""S10A""),collapse = "",""),"
"0","                                                              LAANSTR = ""ALLE"","
"0","                                                              Tid = ""*"")) %>%"
"0","    select(-c(VALUTA, LÃ˜BETID1, LAANSTR, INDSEK)) %>%"
"0","    #mutate(Value = str_replace_all(INDHOLD, pattern = "".."", """")) %>%"
"0","    mutate(Value = as.double(INDHOLD, na.rm = TRUE)/100,"
"0","           RENTFIX = str_replace_all(RENTFIX, pattern = "" - - "", """")) %>%"
"0","    mutate(RENTFIX = str_replace_all(RENTFIX, pattern = "" - "", """")) %>%"
"0","    mutate(RENTFIX = str_replace_all(RENTFIX, pattern = ""- "", """")) %>%"
"0","    mutate(RENTFIX = str_replace_all(RENTFIX, pattern = ""Over 6 months and up to and including 1 year"", ""01 year"")) %>%"
"0","    mutate(RENTFIX = str_replace_all(RENTFIX, pattern = ""Over 1 year and up to and including 2 years"", ""02 year"")) %>%"
"0","    mutate(RENTFIX = str_replace_all(RENTFIX, pattern = ""Over 2 years and up to and including 3 years"", ""03 year"")) %>%"
"0","    mutate(RENTFIX = str_replace_all(RENTFIX, pattern = ""Over 3 years and up to and including 5 years"", ""05 year"")) %>%"
"0","    mutate(RENTFIX = str_replace_all(RENTFIX, pattern = ""Over 5 years and up to and including 10 years"", ""10 year"")) %>%"
"0","    mutate(Interest_Fixation = str_replace_all(RENTFIX, pattern = ""Over 10 years"", ""Fixed"")) %>%"
"0","    mutate(Date = str_replace_all(TID, pattern = ""M"", """")) %>%"
"0","    mutate(Date = paste0(Date, ""01"")) %>%"
"0","    mutate(Date = as.Date(Date,format='%Y%m%d'))  %>%"
"0","    mutate(Interest_Fixation = factor(Interest_Fixation, order = TRUE, "
"0","                                      levels = c(""01 year"","
"0","                                                 ""02 year"","
"0","                                                 ""03 year"", "
"0","                                                 ""05 year"","
"0","                                                 ""10 year"","
"0","                                                 ""Fixed""))) %>%"
"0","    select(-INDHOLD, -RENTFIX, -TID) %>%"
"0","    filter(!is.na(Value))"
"2","Getting data. This can take a while, if the data is very large.
"
"2","Data collected succesfully
"
"2","Problem with `mutate()` input `Value`.
[34mâ„¹[39m NAs introduced by coercion
[34mâ„¹[39m Input `Value` is `as.double(INDHOLD, na.rm = TRUE)/100`."
"2","NAs introduced by coercion"
"0","DK_yield_curves_rates <- dk_mortgage_interest_raw_data %>%"
"0","    filter(DATA != ""Administration rate (per cent) (not indexed)"","
"0","           !is.na(Value)) %>%"
"0","    select(-DATA)"
